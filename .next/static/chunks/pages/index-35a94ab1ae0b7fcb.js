(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(4528)}])},4528:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var a=r(5893),s=r(7294),n=r(1163),i=r(4221);function o(e){let{onSubmit:t,isLoading:r,error:n}=e,[o,l]=(0,s.useState)(""),[c,d]=(0,s.useState)(""),[u,m]=(0,s.useState)(""),[x,h]=(0,s.useState)(!1),p=async e=>{e.preventDefault(),await t(o,c,u)};return(0,a.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.1},className:"bg-background rounded-lg shadow-xl p-6 max-w-md w-full",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-primary mb-4",children:"Welcome to Dark Tide"}),(0,a.jsx)("p",{className:"text-text-secondary mb-6",children:"Please enter your API key and details to continue"}),n&&(0,a.jsx)("div",{className:"bg-red-500/10 border border-red-500 text-red-500 rounded p-3 mb-4",children:n}),(0,a.jsxs)("form",{onSubmit:p,children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,a.jsx)("label",{htmlFor:"apiap",className:"block text-sm font-medium text-text-primary",children:"API Key (APIAP String)"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{l('<html><head></head><body><input id="ap" type="hidden" value="{&quot;Tokens&quot;:[...],&quot;Alias&quot;:&quot;email@example.com&quot;,...}"></body></html>')},className:"text-xs text-primary hover:text-primary/80",children:"Show Example"}),(0,a.jsxs)("button",{type:"button",onClick:()=>h(!x),className:"text-xs text-primary hover:text-primary/80",children:[x?"Hide":"Show"," API Key"]})]})]}),(0,a.jsx)("textarea",{id:"apiap",rows:5,value:o,onChange:e=>l(e.target.value),className:"w-full px-3 py-2 bg-background-secondary border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Paste your APIAP string here",style:{filter:x?"none":"blur(4px)",transition:"filter 0.2s ease"},required:!0}),(0,a.jsxs)("div",{className:"mt-2 space-y-1 text-xs text-text-secondary",children:[(0,a.jsx)("p",{children:"Paste the complete APIAP string from the Vulcan login page. The correct format looks like:"}),(0,a.jsx)("p",{className:"bg-gray-800 p-2 rounded overflow-hidden text-xs",style:{wordBreak:"break-all"},children:(0,a.jsx)("code",{children:'<html><head></head><body><input id="ap" type="hidden" value="{"Tokens": [...] ..."></body></html>'})}),(0,a.jsxs)("p",{children:["The APIAP string ",(0,a.jsx)("strong",{children:"must"})," be in this exact format with the HTML tags and input element."]}),(0,a.jsx)("p",{children:(0,a.jsx)("a",{href:"https://github.com/wulkanowy/qr",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"How to get your APIAP string?"})})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-text-primary mb-1",children:"Your Name"}),(0,a.jsx)("input",{type:"text",id:"name",value:c,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 bg-background-secondary border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Enter your name",required:!0})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-text-primary mb-1",children:"Email Address"}),(0,a.jsx)("input",{type:"email",id:"email",value:u,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 bg-background-secondary border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Enter your email",required:!0})]}),(0,a.jsx)("button",{type:"submit",disabled:r,className:"w-full bg-primary hover:bg-primary/90 text-white py-2 px-4 rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 disabled:opacity-70 disabled:cursor-not-allowed",children:r?(0,a.jsxs)("span",{className:"flex items-center justify-center",children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Verifying..."]}):"Submit"})]})]})})}var l=r(7592),c=r(5654);function d(){let e=(0,n.useRouter)(),[t,r]=(0,s.useState)(!1),[d,u]=(0,s.useState)(!1),[m,x]=(0,s.useState)(null),{setApiap:h}=(0,c.z)();(0,s.useEffect)(()=>{if((0,l.$8)()){let t=setTimeout(()=>{e.push("/dashboard")},1500);return()=>clearTimeout(t)}{let e=setTimeout(()=>{r(!0)},1e3);return()=>clearTimeout(e)}},[e]);let p=async(t,r,a)=>{u(!0),x(null);try{console.log("Authenticating with API key...");let s=await fetch("/api/validate-apiap",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({apiap:t})}),n=await s.json();n.success?(console.log("Authentication successful, saving user data..."),(0,l.gt)(t,r,a),h(t),e.push("/dashboard")):(console.error("Authentication failed:",n.error),x(n.error||"Invalid API key. Please check and try again."))}catch(e){console.error("Authentication error:",e),x(e instanceof Error?e.message:"Failed to validate API key. Please try again.")}finally{u(!1)}};return(0,a.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-background",children:[(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center",children:[(0,a.jsx)("h1",{className:"text-3xl md:text-5xl font-mono font-bold text-primary mb-2",children:"Dark Tide"}),(0,a.jsx)("p",{className:"text-text-secondary mb-6",children:"Electronic Diary"}),(0,a.jsx)(i.E.div,{animate:{scale:[1,1.1,1]},transition:{duration:1.5,repeat:1/0,repeatType:"loop"},children:(0,a.jsx)("div",{className:"w-12 h-12 border-2 border-primary border-t-transparent rounded-full animate-spin mx-auto"})})]}),t&&(0,a.jsx)(o,{onSubmit:p,isLoading:d,error:m})]})}}},function(e){e.O(0,[403,888,774,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);