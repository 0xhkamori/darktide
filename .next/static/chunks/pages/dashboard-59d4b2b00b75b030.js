(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{6117:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return a(8475)}])},8475:function(e,t,a){"use strict";a.r(t);var s=a(5893),i=a(7294),n=a(1464),r=a(6650),o=a(4029),l=a(9681),c=a(4221),d=a(6391),m=a(3839),h=a(8626),u=a(4301),x=a(1350),f=a(159),p=a(1664),S=a.n(p),T=a(5720),g=a(9648),y=a(4917),D=a(7592);t.default=(0,y.Z)(function(){let[e,t]=(0,i.useState)(new Date),{data:a,isLoading:p,error:y}=(0,o.d$)("lessons"),[j,N]=(0,i.useState)([]),[v,w]=(0,i.useState)("Good day"),{name:b,email:E}=(0,D.is)(),H={name:b||"User",class:"ZSE-I",school:"Lodz"};(0,i.useEffect)(()=>{let a=e.getHours();a<6?w("Good night"):a<12?w("Good morning"):a<18?w("Good day"):w("Good evening");let s=setInterval(()=>{t(new Date)},6e4);return()=>clearInterval(s)},[]),(0,i.useEffect)(()=>{if(a&&a.length>0){let e=new Date,t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0"),n="".concat(t,"-").concat(s,"-").concat(i);console.log("[DEBUG] Today's date for filtering:",n);let r=a.filter(e=>{let t=null;if(e.Date){if(e.Date.Timestamp){let a=new Date(e.Date.Timestamp),s=a.getFullYear(),i=String(a.getMonth()+1).padStart(2,"0"),n=String(a.getDate()).padStart(2,"0");t="".concat(s,"-").concat(i,"-").concat(n)}else if(e.Date.Date)t=e.Date.Date;else if(e.Date.DateDisplay){let a=e.Date.DateDisplay.split(".");3===a.length&&(t="".concat(a[2],"-").concat(a[1],"-").concat(a[0]))}else if("object"==typeof e.Date)try{let a=e.Date.Year||e.Date.year,s=e.Date.Month||e.Date.month,i=e.Date.Day||e.Date.day;a&&void 0!==s&&i&&(t="".concat(a,"-").concat(String(s).padStart(2,"0"),"-").concat(String(i).padStart(2,"0")))}catch(e){return console.error("Failed to parse lesson date:",e),!1}}else"string"==typeof e.Date&&(t=e.Date.split("T")[0]);return console.log("[DEBUG] Lesson date: ".concat(t,", comparing with today: ").concat(n)),t===n});console.log("[DEBUG] Filtered ".concat(r.length," lessons for today:"),r);let o=r.sort((e,t)=>{let a,s;try{if(e.TimeSlot&&e.TimeSlot.Start){let[t,s]=e.TimeSlot.Start.split(":").map(Number);a=new Date(0,0,0,t||0,s||0)}else a=e.TimeStart?"string"==typeof e.TimeStart?new Date(e.TimeStart):e.TimeStart&&void 0!==e.TimeStart.Hour?new Date(0,0,0,e.TimeStart.Hour,e.TimeStart.Minute||0):new Date:new Date;if(t.TimeSlot&&t.TimeSlot.Start){let[e,a]=t.TimeSlot.Start.split(":").map(Number);s=new Date(0,0,0,e||0,a||0)}else s=t.TimeStart?"string"==typeof t.TimeStart?new Date(t.TimeStart):t.TimeStart&&void 0!==t.TimeStart.Hour?new Date(0,0,0,t.TimeStart.Hour,t.TimeStart.Minute||0):new Date:new Date}catch(e){return console.error("Error parsing lesson time:",e),0}return a.getTime()-s.getTime()}),l=new Date,c=l.getHours(),d=l.getMinutes();N(o.map(e=>{let t=!1,a=0,s=0,i=0,n=0;if(e.TimeSlot){if(e.TimeSlot.Start&&e.TimeSlot.End){let t=e.TimeSlot.Start.split(":").map(Number),r=e.TimeSlot.End.split(":").map(Number);a=t[0]||0,s=t[1]||0,i=r[0]||0,n=r[1]||0}}else if(e.TimeStart&&e.TimeEnd){if("string"==typeof e.TimeStart&&"string"==typeof e.TimeEnd){let t=new Date(e.TimeStart),r=new Date(e.TimeEnd);a=t.getHours(),s=t.getMinutes(),i=r.getHours(),n=r.getMinutes()}else void 0!==e.TimeStart.Hour&&void 0!==e.TimeEnd.Hour&&(a=e.TimeStart.Hour||0,s=e.TimeStart.Minute||0,i=e.TimeEnd.Hour||0,n=e.TimeEnd.Minute||0)}let r=60*i+n,o=60*c+d;return t=o>=60*a+s&&o<=r,{...e,isCurrentLesson:t}}))}},[a,e]);let M=[{title:"Schedule",icon:d.f,color:"bg-accent",href:"/dashboard/schedule"},{title:"Grades",icon:m.X,color:"bg-primary",href:"/dashboard/grades"},{title:"Attendance",icon:h.y,color:"bg-secondary",href:"/dashboard/attendance"},{title:"Homework",icon:u.B,color:"bg-green-500",href:"/dashboard/homework"}];return(0,s.jsxs)(n.Z,{children:[(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsxs)(c.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold mb-1",children:[v,"!"]}),(0,s.jsx)("p",{className:"text-text-secondary",children:(0,l.p6)(e,"EEEE, d MMMM")})]})}),p?(0,s.jsx)(T.Z,{text:"Loading schedule..."}):y?(0,s.jsx)(g.Z,{message:y.message}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"mb-6",children:(0,s.jsx)(r.Z,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"w-14 h-14 rounded-full bg-primary flex items-center justify-center text-white text-xl font-bold",children:H.name.split(" ").map(e=>e[0]).join("")}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)(S(),{href:"/dashboard/profile",children:(0,s.jsx)("h2",{className:"text-lg font-bold",children:H.name})}),(0,s.jsxs)("div",{className:"text-text-secondary text-xs space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(x.p,{size:12,className:"mr-1"}),(0,s.jsxs)("span",{children:["Class ",H.class]})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(f.N,{size:12,className:"mr-1"}),(0,s.jsx)("span",{children:H.school})]})]})]})]})})}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-3 mb-6",children:M.map((e,t)=>(0,s.jsx)(S(),{href:e.href,onClick:t=>{t.preventDefault(),window.location.href=e.href},children:(0,s.jsxs)(r.Z,{className:"p-4",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full ".concat(e.color," flex items-center justify-center mb-3"),children:(0,s.jsx)(e.icon,{size:24,weight:"bold",className:"text-white"})}),(0,s.jsx)("h3",{className:"font-medium",children:e.title})]})},t))}),(0,s.jsx)("h2",{className:"text-xl font-mono font-bold mb-4",children:"Today"}),j.length>0?(0,s.jsx)("div",{className:"space-y-3",children:j.map((e,t)=>{var a,i,n,o;return(0,s.jsx)(r.Z,{className:"p-4 ".concat(e.isCurrentLesson?"border-2 border-accent":""),withHover:!1,children:(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium text-text-primary",children:(null===(a=e.Subject)||void 0===a?void 0:a.Name)||e.Subject||"Lesson"}),(0,s.jsxs)("p",{className:"text-sm text-text-secondary",children:[(null===(i=e.Room)||void 0===i?void 0:i.Code)?"Room: ".concat(e.Room.Code):e.Room?"Room: ".concat(e.Room):"",(null===(n=e.TeacherPrimary)||void 0===n?void 0:n.DisplayName)?" • ".concat(e.TeacherPrimary.DisplayName):e.Teacher?" • ".concat(e.Teacher):""]})]}),(0,s.jsx)("div",{className:"bg-surface px-3 py-1 rounded-full text-text-secondary text-sm",children:(null===(o=e.TimeSlot)||void 0===o?void 0:o.Display)||(e.TimeStart&&e.TimeEnd?"".concat((0,l.mr)(e.TimeStart)," - ").concat((0,l.mr)(e.TimeEnd)):e.TimeSlot?"".concat(e.TimeSlot.Start," - ").concat(e.TimeSlot.End):"Time not specified")})]})},t)})}):(0,s.jsx)(r.Z,{className:"p-6 text-center",withHover:!1,children:(0,s.jsx)("p",{className:"text-text-secondary",children:"No lessons for today"})})]})]})})}},function(e){e.O(0,[403,690,435,562,2,888,774,179],function(){return e(e.s=6117)}),_N_E=e.O()}]);