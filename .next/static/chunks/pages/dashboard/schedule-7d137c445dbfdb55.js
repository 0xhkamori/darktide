(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[146],{3257:function(e,t,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/schedule",function(){return o(6968)}])},6968:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return A}});var a=o(5893),l=o(7294),r=o(1464),n=o(6650),s=o(5720),i=o(9648),c=o(4029),m=o(9681),p=o(4221),d=o(3492);let f=new Map([["bold",l.createElement(l.Fragment,null,l.createElement("path",{d:"M168.49,199.51a12,12,0,0,1-17,17l-80-80a12,12,0,0,1,0-17l80-80a12,12,0,0,1,17,17L97,128Z"}))],["duotone",l.createElement(l.Fragment,null,l.createElement("path",{d:"M160,48V208L80,128Z",opacity:"0.2"}),l.createElement("path",{d:"M163.06,40.61a8,8,0,0,0-8.72,1.73l-80,80a8,8,0,0,0,0,11.32l80,80A8,8,0,0,0,168,208V48A8,8,0,0,0,163.06,40.61ZM152,188.69,91.31,128,152,67.31Z"}))],["fill",l.createElement(l.Fragment,null,l.createElement("path",{d:"M168,48V208a8,8,0,0,1-13.66,5.66l-80-80a8,8,0,0,1,0-11.32l80-80A8,8,0,0,1,168,48Z"}))],["light",l.createElement(l.Fragment,null,l.createElement("path",{d:"M164.24,203.76a6,6,0,1,1-8.48,8.48l-80-80a6,6,0,0,1,0-8.48l80-80a6,6,0,0,1,8.48,8.48L88.49,128Z"}))],["regular",l.createElement(l.Fragment,null,l.createElement("path",{d:"M165.66,202.34a8,8,0,0,1-11.32,11.32l-80-80a8,8,0,0,1,0-11.32l80-80a8,8,0,0,1,11.32,11.32L91.31,128Z"}))],["thin",l.createElement(l.Fragment,null,l.createElement("path",{d:"M162.83,205.17a4,4,0,0,1-5.66,5.66l-80-80a4,4,0,0,1,0-5.66l80-80a4,4,0,1,1,5.66,5.66L85.66,128Z"}))]]);var y=Object.defineProperty,h=Object.defineProperties,u=Object.getOwnPropertyDescriptors,g=Object.getOwnPropertySymbols,b=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable,S=(e,t,o)=>t in e?y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,x=(e,t)=>{for(var o in t||(t={}))b.call(t,o)&&S(e,o,t[o]);if(g)for(var o of g(t))j.call(t,o)&&S(e,o,t[o]);return e},D=(e,t)=>h(e,u(t));let T=(0,l.forwardRef)((e,t)=>l.createElement(d.Z,D(x({ref:t},e),{weights:f})));T.displayName="CaretLeft";let E=new Map([["bold",l.createElement(l.Fragment,null,l.createElement("path",{d:"M184.49,136.49l-80,80a12,12,0,0,1-17-17L159,128,87.51,56.49a12,12,0,1,1,17-17l80,80A12,12,0,0,1,184.49,136.49Z"}))],["duotone",l.createElement(l.Fragment,null,l.createElement("path",{d:"M176,128,96,208V48Z",opacity:"0.2"}),l.createElement("path",{d:"M181.66,122.34l-80-80A8,8,0,0,0,88,48V208a8,8,0,0,0,13.66,5.66l80-80A8,8,0,0,0,181.66,122.34ZM104,188.69V67.31L164.69,128Z"}))],["fill",l.createElement(l.Fragment,null,l.createElement("path",{d:"M181.66,133.66l-80,80A8,8,0,0,1,88,208V48a8,8,0,0,1,13.66-5.66l80,80A8,8,0,0,1,181.66,133.66Z"}))],["light",l.createElement(l.Fragment,null,l.createElement("path",{d:"M180.24,132.24l-80,80a6,6,0,0,1-8.48-8.48L167.51,128,91.76,52.24a6,6,0,0,1,8.48-8.48l80,80A6,6,0,0,1,180.24,132.24Z"}))],["regular",l.createElement(l.Fragment,null,l.createElement("path",{d:"M181.66,133.66l-80,80a8,8,0,0,1-11.32-11.32L164.69,128,90.34,53.66a8,8,0,0,1,11.32-11.32l80,80A8,8,0,0,1,181.66,133.66Z"}))],["thin",l.createElement(l.Fragment,null,l.createElement("path",{d:"M178.83,130.83l-80,80a4,4,0,0,1-5.66-5.66L170.34,128,93.17,50.83a4,4,0,0,1,5.66-5.66l80,80A4,4,0,0,1,178.83,130.83Z"}))]]);var N=Object.defineProperty,w=Object.defineProperties,v=Object.getOwnPropertyDescriptors,O=Object.getOwnPropertySymbols,P=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable,Z=(e,t,o)=>t in e?N(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,L=(e,t)=>{for(var o in t||(t={}))P.call(t,o)&&Z(e,o,t[o]);if(O)for(var o of O(t))M.call(t,o)&&Z(e,o,t[o]);return e},C=(e,t)=>w(e,v(t));let F=(0,l.forwardRef)((e,t)=>l.createElement(d.Z,C(L({ref:t},e),{weights:E})));function A(){let{data:e,isLoading:t,error:o}=(0,c.d$)("lessons"),[d,f]=(0,l.useState)(new Date),[y,h]=(0,l.useState)([]),[u,g]=(0,l.useState)([]);(0,l.useEffect)(()=>{console.log("Lessons API response:",e),e&&e.length>0?(console.log("Sample lesson structure:",e[0]),console.log("LESSON KEYS:",Object.keys(e[0])),console.log("TimeSlot:",e[0].TimeSlot?Object.keys(e[0].TimeSlot):"Not found"),console.log("Date field type:",e[0].Date?typeof e[0].Date:"undefined"),e[0].Date&&"object"==typeof e[0].Date&&console.log("Date object structure:",e[0].Date)):console.log("No lessons received")},[e]),(0,l.useEffect)(()=>{let e=[],t=new Date(d),o=t.getDay(),a=new Date(t);a.setDate(t.getDate()-(0===o?6:o-1));for(let t=0;t<7;t++){let o=new Date(a);o.setDate(a.getDate()+t),e.push(o)}h(e),console.log("Week dates:",e.map(e=>(0,m.p6)(e))),console.log("Selected date:",(0,m.p6)(d))},[d]),(0,l.useEffect)(()=>{if(e&&e.length>0){let t=d.toISOString().split("T")[0];console.log("Target date for filtering:",t);let o=e.filter(e=>{let o;if(e.Date){if("object"==typeof e.Date&&e.Date.Date)o=e.Date.Date,console.log("Lesson date from object.Date: ".concat(o,", selected: ").concat(t));else if("string"==typeof e.Date)o=e.Date.split("T")[0];else if(e.Date instanceof Date)o=e.Date.toISOString().split("T")[0];else if(e.Date&&"object"==typeof e.Date)try{let t=e.Date.Year||e.Date.year,a=(e.Date.Month||e.Date.month)-1,l=e.Date.Day||e.Date.day;t&&void 0!==a&&l&&(o=new Date(t,a,l).toISOString().split("T")[0])}catch(e){console.error("Failed to parse lesson date:",e)}}return o?(console.log("Lesson date: ".concat(o,", matches selected date: ").concat(o===t)),o===t):(console.log("Could not extract date from lesson:",e),!1)});console.log("Filtered lessons for ".concat(t,":"),o.length);let a=o.sort((e,t)=>e.TimeSlot&&t.TimeSlot&&void 0!==e.TimeSlot.Position&&void 0!==t.TimeSlot.Position?(console.log("Sorting by TimeSlot.Position: ".concat(e.TimeSlot.Position," vs ").concat(t.TimeSlot.Position)),e.TimeSlot.Position-t.TimeSlot.Position):void 0!==e.Position&&void 0!==t.Position?e.Position-t.Position:0);console.log("Final sorted lessons:",a),g(a)}},[e,d]);let b=e=>{f(e)},j=e=>{let t=new Date;return e.toDateString()===t.toDateString()},S=e=>e.toDateString()===d.toDateString();return(0,a.jsxs)(r.Z,{title:"Schedule",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("button",{onClick:()=>{let e=new Date(d);e.setDate(e.getDate()-7),f(e)},className:"p-2 bg-surface rounded-full hover:bg-overlay transition-colors",children:(0,a.jsx)(T,{size:20})}),(0,a.jsxs)("h2",{className:"font-mono text-lg",children:[(0,m.p6)(y[0],"dd.MM")," - ",(0,m.p6)(y[6],"dd.MM")]}),(0,a.jsx)("button",{onClick:()=>{let e=new Date(d);e.setDate(e.getDate()+7),f(e)},className:"p-2 bg-surface rounded-full hover:bg-overlay transition-colors",children:(0,a.jsx)(F,{size:20})})]}),(0,a.jsx)("div",{className:"flex space-x-2 overflow-x-auto pb-2",children:y.map((e,t)=>(0,a.jsxs)("button",{onClick:()=>b(e),className:"flex-shrink-0 w-14 h-14 rounded-xl flex flex-col items-center justify-center transition-all ".concat(S(e)?"bg-primary text-white":j(e)?"bg-surface border border-primary text-primary":"bg-surface text-text-secondary hover:bg-overlay/50"),children:[(0,a.jsx)("span",{className:"text-xs",children:(0,m.p6)(e,"EEE").slice(0,1)}),(0,a.jsx)("span",{className:"font-bold",children:(0,m.p6)(e,"d")})]},t))})]}),t?(0,a.jsx)(s.Z,{text:"Loading schedule..."}):o?(0,a.jsx)(i.Z,{message:o.message}):(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h3",{className:"font-medium text-text-secondary mb-2",children:[(0,m.ji)(d),", ",(0,m.p6)(d)]}),u.length>0?(0,a.jsx)(p.E.div,{className:"space-y-3",initial:{opacity:0},animate:{opacity:1},transition:{staggerChildren:.1},children:u.map((e,t)=>{let o="Lesson";e.Subject?"string"==typeof e.Subject?o=e.Subject:e.Subject.Name?o=e.Subject.Name:"object"==typeof e.Subject&&(o=JSON.stringify(e.Subject)):e.subject&&("string"==typeof e.subject?o=e.subject:"object"==typeof e.subject&&(o=JSON.stringify(e.subject)));let l="";if(e.Room){if("string"==typeof e.Room)l=e.Room;else if(e.Room.Name)l=e.Room.Name;else if(e.Room.Code)l=e.Room.Code;else if("object"==typeof e.Room)try{l=e.Room.Code||""}catch(e){l=""}}else if(e.room){if("string"==typeof e.room)l=e.room;else if(e.room.Code)l=e.room.Code;else if("object"==typeof e.room)try{l=e.room.Code||""}catch(e){l=""}}let r="";e.Teacher?"string"==typeof e.Teacher?r=e.Teacher:e.Teacher.DisplayName?r=e.Teacher.DisplayName:"object"==typeof e.Teacher&&(r=JSON.stringify(e.Teacher)):e.teacher?"string"==typeof e.teacher?r=e.teacher:"object"==typeof e.teacher&&(r=JSON.stringify(e.teacher)):e.TeacherPrimary&&("string"==typeof e.TeacherPrimary?r=e.TeacherPrimary:e.TeacherPrimary.DisplayName?r=e.TeacherPrimary.DisplayName:"object"==typeof e.TeacherPrimary&&(r=JSON.stringify(e.TeacherPrimary)));let s="";e.Topic?"string"==typeof e.Topic?s=e.Topic:"object"==typeof e.Topic&&(s=JSON.stringify(e.Topic)):e.topic&&("string"==typeof e.topic?s=e.topic:"object"==typeof e.topic&&(s=JSON.stringify(e.topic)));let i="",c="",m="",d="";if(e.TimeSlot){if(e.TimeSlot.Display){console.log("Using TimeSlot.Display for ".concat(o,": ").concat(e.TimeSlot.Display));let t=e.TimeSlot.Display.split("-");2===t.length?(i=t[0],c=t[1]):d=e.TimeSlot.Display}else e.TimeSlot.Start&&e.TimeSlot.End&&(i=e.TimeSlot.Start,c=e.TimeSlot.End);void 0!==e.TimeSlot.Position&&(m=String(e.TimeSlot.Position))}return e.TimeSlot&&e.TimeSlot.Display?(d=e.TimeSlot.Display,m&&(d="".concat(m,". ").concat(d))):m?(d="Lesson ".concat(m),i&&(c?d+=" (".concat(i,"-").concat(c,")"):d+=" (".concat(i,")"))):d=i?c?"".concat(i,"-").concat(c):i:"N/A",(0,a.jsx)(p.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.05*t},children:(0,a.jsx)(n.Z,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-medium text-text-primary",children:o}),(0,a.jsxs)("div",{className:"text-sm text-text-secondary space-y-1",children:[l&&(0,a.jsxs)("p",{children:["Room: ",l]}),r&&(0,a.jsxs)("p",{children:["Teacher: ",r]}),s&&(0,a.jsxs)("p",{children:["Topic: ",s]})]})]}),(0,a.jsx)("div",{className:"bg-surface px-3 py-1 rounded-full text-text-secondary text-sm whitespace-nowrap ml-2",children:d})]})})},t)})}):(0,a.jsx)(n.Z,{className:"p-6 text-center",children:(0,a.jsx)("p",{className:"text-text-secondary",children:"No lessons for this day"})})]})]})}F.displayName="CaretRight"}},function(e){e.O(0,[403,690,435,298,888,774,179],function(){return e(e.s=3257)}),_N_E=e.O()}]);